<div class="demo-container">
  <header class="demo-header">
    <div class="header-nav">
      <a routerLink="/rick-morty" class="nav-link">ğŸ›¸ Try Rick & Morty Demo â†’</a>
    </div>
    <h1>&#64;ng-search/core Demo</h1>
    <p>Search through Angular tutorials and guides</p>
  </header>

  <div class="search-container">
    <!-- Search Box with inline suggestions -->
    <div class="search-box-wrapper">
      <ngs-search-box
        [value]="inputValue()"
        placeholder="Search tutorials, guides, and more..."
        [debounceTime]="300"
        [minQueryLength]="2"
        [showClearButton]="true"
        [disableAutoSearch]="true"
        ariaLabel="Search Angular tutorials"
        (queryChange)="onQueryChange($event)"
        (search)="onSearch($event)">

        <!-- Custom search actions using content projection -->
        <div searchActions class="custom-actions">
          <button
            type="button"
            class="search-btn"
            [disabled]="!inputValue()"
            (click)="searchProvider.executeSearch()">
            ğŸ” Search
          </button>
          <!-- <button
            type="button"
            class="filter-btn"
            (click)="toggleFilters()">
            ğŸ¯ Filters
          </button> -->
        </div>
      </ngs-search-box>

      <!-- Suggestions dropdown positioned below search box -->
      <ng-search-suggestions
        [maxSuggestions]="8"
        [autoHighlightFirst]="true"
        [showNoResults]="false"
        (suggestionSelected)="onSuggestionSelected($event)">

        <!-- Custom suggestion template -->
        <ng-template #suggestionTemplate let-suggestion let-index="index" let-highlighted="highlighted">
          <div class="custom-suggestion" [class.active]="highlighted">
            <div class="suggestion-icon">
              @if (suggestion.metadata?.type === 'tutorial') {
                ğŸ“š
              } @else if (suggestion.metadata?.type === 'guide') {
                ğŸ“–
              } @else {
                ğŸ”
              }
            </div>
            <div class="suggestion-content">
              <div class="suggestion-title">{{ suggestion.text }}</div>
              @if (suggestion.metadata?.category) {
                <div class="suggestion-meta">{{ suggestion.metadata.category }}</div>
              }
            </div>
            @if (suggestion.count !== undefined) {
              <span class="suggestion-badge">{{ suggestion.count }}</span>
            }
          </div>
        </ng-template>
      </ng-search-suggestions>
    </div>

    <!-- Search Results -->
    <ng-search-results
      [pageSize]="5"
      [showPagination]="true"
      [enableVirtualScroll]="false"
      [highlightQuery]="true"
      (pageChange)="onPageChange($event)"
      emptyMessage="No tutorials found. Try a different search term.">

      <!-- Custom result template -->
      <ng-template #resultTemplate let-result let-index="index" let-query="query">
        <div class="custom-result">
          <div class="result-badge">{{ index + 1 }}</div>
          <div class="result-content">
            <h3 class="result-title">
              @if (result.data.url) {
                <a [href]="result.data.url" target="_blank" rel="noopener noreferrer" class="result-link">
                  {{ result.data.title }}
                  <svg class="external-link-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                    <polyline points="15 3 21 3 21 9"></polyline>
                    <line x1="10" y1="14" x2="21" y2="3"></line>
                  </svg>
                </a>
              } @else {
                {{ result.data.title }}
              }
              @if (result.data.category) {
                <span class="result-category">{{ result.data.category }}</span>
              }
            </h3>
            <p class="result-description">{{ result.data.description }}</p>
            <div class="result-footer">
              @if (result.data.difficulty) {
                <span class="difficulty-badge" [attr.data-level]="result.data.difficulty">
                  {{ result.data.difficulty }}
                </span>
              }
              @if (result.data.tags && result.data.tags.length > 0) {
                <div class="result-tags">
                  @for (tag of result.data.tags; track tag) {
                    <span class="tag">{{ tag }}</span>
                  }
                </div>
              }
              @if (result.score !== undefined) {
                <span class="result-score">Score: {{ result.score.toFixed(2) }}</span>
              }
            </div>
          </div>
        </div>
      </ng-template>
    </ng-search-results>
  </div>
</div>
